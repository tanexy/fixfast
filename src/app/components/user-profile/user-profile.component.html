<ActionBar title="Profile" backgroundColor="#1E293B" color="white"></ActionBar>

<ScrollView backgroundColor="#F8FAFC">
  <StackLayout class="profile-container">

    <!-- Modern Profile Header -->
    <StackLayout class="profile-header">
      <GridLayout rows="auto, auto" class="header-content">
        <!-- Avatar and Basic Info -->
        <StackLayout row="0" class="avatar-container">
          <Label [text]="getInitials()" class="avatar-circle"></Label>
          <Label text="✏️" class="edit-badge" (tap)="editProfile()"></Label>
        </StackLayout>

        <StackLayout row="1" class="profile-details">
          <Label [text]="profile.Username" class="profile-name"></Label>
          <Label [text]="profile.Email" class="profile-email"></Label>

          <GridLayout columns="auto, auto" class="profile-meta">
            <StackLayout col="0" class="meta-item">
              <Label [text]="profile.Role" class="meta-badge role-badge"></Label>
            </StackLayout>
            <StackLayout col="1" class="meta-item">
              <Label [text]="" class="meta-badge dept-badge">N/A</Label>
            </StackLayout>
          </GridLayout>
        </StackLayout>
      </GridLayout>
    </StackLayout>

    <!-- Stats Overview Cards -->
    <GridLayout columns="*, *, *" class="stats-row">
      <StackLayout col="0" class="stat-mini-card">
        <Label [text]="" class="stat-mini-number">5</Label>
        <Label text="Reported" class="stat-mini-label"></Label>
      </StackLayout>

      <StackLayout col="1" class="stat-mini-card stat-mini-middle">
        <Label [text]="" class="stat-mini-number">6</Label>
        <Label text="Resolved" class="stat-mini-label"></Label>
      </StackLayout>

      <StackLayout col="2" class="stat-mini-card">
        <Label [text]="stats.ticketsThisMonth.toString()" class="stat-mini-number"></Label>
        <Label text="This Month" class="stat-mini-label"></Label>
      </StackLayout>
    </GridLayout>

    <!-- Quick Actions Grid -->
    <StackLayout class="section-wrapper">
      <Label text="Quick Actions" class="section-header"></Label>

      <GridLayout columns="*, *" rows="auto, auto" class="quick-actions-grid">
        <StackLayout *ngFor="let action of quickActions; let i = index" [col]="i % 2" [row]="i < 2 ? 0 : 1"
          class="quick-action-card" (tap)="onQuickAction(action)">
          <Label [text]="action.icon" class="action-icon"></Label>
          <Label [text]="action.label" class="action-label"></Label>
        </StackLayout>
      </GridLayout>
    </StackLayout>

    <!-- Recent Activity -->
    <StackLayout class="section-wrapper" *ngIf="recentTickets.length > 0">
      <GridLayout columns="*, auto" class="section-header-row">
        <Label col="0" text="Recent Activity" class="section-header"></Label>
        <Label col="1" text="View All →" class="view-all-link" (tap)="navigateTo('/tickets')"></Label>
      </GridLayout>

      <StackLayout class="activity-list">
        <GridLayout *ngFor="let ticket of recentTickets" columns="auto, *, auto" class="activity-item"
          (tap)="navigateTo('/tickets')">

          <Label col="0" text="📋" class="activity-icon"></Label>

          <StackLayout col="1" class="activity-info">
            <Label [text]="ticket.title" class="activity-title"></Label>
            <Label [text]="ticket.location + ' • ' + (ticket.createdAt | date:'MMM dd')"
              class="activity-subtitle"></Label>
          </StackLayout>

          <Label col="2" [text]="ticket.status.replace('-', ' ')"
            [backgroundColor]="getTicketStatusColor(ticket.status)" class="activity-status"></Label>
        </GridLayout>
      </StackLayout>
    </StackLayout>

    <!-- Menu Items -->
    <StackLayout class="section-wrapper">
      <Label text="Settings & More" class="section-header"></Label>

      <StackLayout class="menu-list">
        <GridLayout *ngFor="let item of menuItems" columns="auto, *, auto" class="menu-item"
          (tap)="onMenuItem(item.action)">

          <Label col="0" [text]="item.icon" class="menu-icon"></Label>
          <Label col="1" [text]="item.label" class="menu-label"></Label>
          <Label col="2" text="›" class="menu-arrow"></Label>
        </GridLayout>
      </StackLayout>
    </StackLayout>

    <!-- Logout Button 'Member since ' + (profile.joinDate | date:'MMMM yyyy') -->
    <StackLayout class="logout-section">
      <Button text="Logout" (tap)="logout()" class="btn-logout"></Button>
      <Label [text]="" class="member-since"></Label>
    </StackLayout>

  </StackLayout>
</ScrollView>